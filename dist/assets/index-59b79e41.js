var V=Object.defineProperty;var X=(e,r,t)=>r in e?V(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var j=(e,r,t)=>(X(e,typeof r!="symbol"?r+"":r,t),t);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function T(e,r){let t=e.x-r.x,n=e.y-r.y;return Math.sqrt(t*t+n*n)}function Y(e,r){let t=e.x-r.x,n=e.y-r.y;return t*t+n*n}class w{constructor(r,t,n,o,a,i,d,l=.99){j(this,"mousePinned",!1);j(this,"isPinned",()=>this.pinned||this.mousePinned);this.x=r,this.y=t,this.oldx=n,this.oldy=o,this.pinned=a,this.radius=i,this.renderOverride=d,this.friction=l}isCoOrdinateInside(r,t){return Y(this,{x:r,y:t})<2*this.radius*this.radius}mouseDown(r,t){return this.isCoOrdinateInside(r,t)?(this.mousePinned=!0,!0):!1}mouseMove(r,t){this.mousePinned&&(this.x=this.oldx=r,this.y=this.oldy=t)}mouseUp(){this.mousePinned=!1}update(r,t){if(this.pinned||this.mousePinned)return;let n=this.x-this.oldx,o=this.y-this.oldy;this.oldx=this.x,this.oldy=this.y,this.x+=this.friction*Math.min(n,20),this.y+=this.friction*Math.min(o,20),this.constraintNodes(r,t),this.contriantSpeed()}constraintNodes(r,t){let n=this.x-this.oldx,o=this.y-this.oldy;this.x+this.radius>r&&(this.x=r-this.radius,this.oldx=this.x+n),this.x<this.radius&&(this.x=this.radius,this.oldx=this.x+n),this.y+this.radius>t&&(this.y=t-this.radius,this.oldy=this.y+o),this.y<this.radius&&(this.y=this.radius,this.oldy=this.y+o)}contriantSpeed(){Math.abs(this.x-this.oldx)>30&&(this.oldx=30-this.x+this.oldx),Math.abs(this.y-this.oldy)>30&&(this.oldy=30-this.y+this.oldy)}applyForce(r,t){this.x+=r,this.y+=t}distanceFrom(r,t){return T(this,{x:r,y:t})}render(r){this.renderOverride(r,this)}}function R(e,r){return function(t,n){let o=n.pinned?"white":"grey",a=n.pinned?"grey":"black";t.beginPath(),t.lineWidth=e,t.arc(n.x,n.y,n.radius,0,2*Math.PI),t.fillStyle=o,t.fill(),t.lineWidth=2,t.strokeStyle=a,t.stroke(),t.lineWidth=1,t.fillStyle=a,t.font="16px Arial",t.fillText(r,n.x-n.radius/2,n.y-2*n.radius),t.fillStyle="black"}}class q{constructor(r,t,n,o=.5,a){j(this,"elems",[]);this.elem1_pointer=r,this.elem2_pointer=t,this.distance=n,this.elasticity=o,this.renderOverride=a}update(){if(this.distance=="dynamic")return;let r=T(this.elem1_pointer,this.elem2_pointer)<.001?.001:T(this.elem1_pointer,this.elem2_pointer),t=r-this.distance,n=this.elem1_pointer.x-this.elem2_pointer.x,o=this.elem1_pointer.y-this.elem2_pointer.y,a=this.elasticity*t*n/(2*r),i=this.elasticity*t*o/(2*r);this.elem1_pointer.isPinned()||(this.elem1_pointer.x-=a,this.elem1_pointer.y-=i),this.elem2_pointer.isPinned()||(this.elem2_pointer.x+=a,this.elem2_pointer.y+=i)}render(r){this.renderOverride(r,this)}}function z(e,r){return function(t,n){t.beginPath(),t.lineWidth=r;let o=T(n.elem1_pointer,n.elem2_pointer),a=(n.elem1_pointer.x-n.elem2_pointer.x)/o,i=(n.elem1_pointer.y-n.elem2_pointer.y)/o;G(t,n.elem1_pointer.x-a*n.elem2_pointer.radius,n.elem1_pointer.y-i*n.elem1_pointer.radius,n.elem2_pointer.x+a*n.elem2_pointer.radius,n.elem2_pointer.y+i*n.elem2_pointer.radius),t.strokeStyle=e,t.stroke()}}function G(e,r,t,n,o){var a=7,i=n-r,d=o-t,l=Math.atan2(d,i);e.moveTo(r,t),e.lineTo(n,o),e.lineTo(n-a*Math.cos(l-Math.PI/6),o-a*Math.sin(l-Math.PI/6)),e.moveTo(n,o),e.lineTo(n-a*Math.cos(l+Math.PI/6),o-a*Math.sin(l+Math.PI/6))}class H{constructor(r,t,n=.1){j(this,"width",0);j(this,"height",0);j(this,"allElemRepelEachOther",!1);this.canvas=r,this.friction=n,this.width=r.width,this.height=r.height,this.allElemRepelEachOther=t}}class Q extends H{constructor(t,n,o,a){a===void 0&&(a=!1);super(t,a);j(this,"mousePinned");this.canvas=t,this.elems=n,this.constraint=o,window.addEventListener("keydown",i=>{if(console.log(i.code),i.code=="KeyD")this.mousePinned&&(this.mousePinned.mouseUp(),this.elems=this.elems.filter(d=>d!=this.mousePinned),this.constraint=this.constraint.filter(d=>d instanceof q&&this.mousePinned instanceof w?d.elem1_pointer!==this.mousePinned&&this.mousePinned!==d.elem2_pointer:!0));else if(i.code=="KeyP"){let d=this.mousePinned;d&&d instanceof w&&(d.pinned=!0)}else if(i.code=="KeyU"){let d=this.mousePinned;d&&d instanceof w&&(d.pinned=!1)}}),t.addEventListener("mousedown",i=>{let d=t.getBoundingClientRect();this.elems.forEach(l=>{this.mousePinned||l.mouseDown(i.clientX-d.left,i.clientY-d.top)&&(this.mousePinned=l)})}),t.addEventListener("mousemove",i=>{if(this.mousePinned){let d=t.getBoundingClientRect();this.mousePinned.mouseMove(i.clientX-d.left,i.clientY-d.top)}}),t.addEventListener("mouseup",()=>{this.mousePinned&&this.mousePinned.mouseUp(),this.mousePinned=void 0})}repel(){if(this.allElemRepelEachOther!=!1)for(let t=0;t<this.elems.length;++t){let n=this.elems[t];if(n instanceof w&&!n.isPinned())for(let o=t+1;o<this.elems.length;++o){let a=this.elems[o];if(a instanceof w&&!a.isPinned()){let i=T(n,a)+1,d={x:(n.x-a.x)/i,y:(n.y-a.y)/i};n.applyForce(d.x*this.allElemRepelEachOther/2,d.y*this.allElemRepelEachOther/2),a.applyForce(-1*d.x*this.allElemRepelEachOther/2,-1*d.y*this.allElemRepelEachOther/2)}}}}run(){let t=this.canvas.getContext("2d");if(t===null)return;let n=o=>{o.clearRect(0,0,this.width,this.height),this.repel(),this.elems.forEach(a=>a.update(this.width,this.height)),this.constraint.forEach(a=>a.update()),this.constraint.forEach(a=>a.render(o)),this.elems.forEach(a=>a.render(o)),requestAnimationFrame(()=>n(o))};n(t)}}var N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E={},O={},B={},J={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.assert_is_pojo=e.isPojo=e.isPojoArray=e.isPojoObject=e.isPojoPrimitve=void 0;var r=function(i){return typeof i=="string"||typeof i=="boolean"||typeof i=="number"||typeof i>"u"||typeof i=="object"&&i===null};e.isPojoPrimitve=r;var t=function(i){return typeof i=="object"&&i!==null};e.isPojoObject=t;var n=function(i){return Array.isArray(i)};e.isPojoArray=n;var o=function(i){return e.isPojoPrimitve(i)||e.isPojoObject(i)||e.isPojoArray(i)};e.isPojo=o;function a(i){if(!e.isPojo(i))throw"Value `"+i+"` is not a type that can be parsed by this library. Only primitive JS values and regular JS objects or arrays can be parsed, not classes (think anything that is valid JSON)."}e.assert_is_pojo=a})(J);var C={};Object.defineProperty(C,"__esModule",{value:!0});C.tag=void 0;var Z=function(e,r){e[r]=!0};C.tag=Z;var F;function K(){return F||(F=1,function(e){var r=N&&N.__assign||function(){return r=Object.assign||function(s){for(var h,g=1,b=arguments.length;g<b;g++){h=arguments[g];for(var P in h)Object.prototype.hasOwnProperty.call(h,P)&&(s[P]=h[P])}return s},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.record=e.field=e.fields=e.fieldDecoder=e.tuple=e.literal=void 0;var t=J,n=L(),o=C,a=function(s){return function(h){if(t.assert_is_pojo(h),s!==h)throw"The value `"+JSON.stringify(h)+"` is not the literal `"+JSON.stringify(s)+"`";return s}};e.literal=a;var i=function(s,h){return function(g){if(t.assert_is_pojo(g),!Array.isArray(g))throw"The value `"+JSON.stringify(g)+"` is not a list and can therefore not be parsed as a tuple";if(g.length!==2)throw"The array `"+JSON.stringify(g)+"` is not the proper length for a tuple";var b=g[0],P=g[1];return[n.decode(s)(b),n.decode(h)(P)]}};e.tuple=i,e.fieldDecoder=Symbol("field-decoder");var d=function(s,h){var g=function(b){t.assert_is_pojo(b);var P=n.decode(s)(b);return h(P)};return o.tag(g,e.fieldDecoder),g};e.fields=d;var l=function(s,h){var g;return e.fields((g={},g[s]=h,g),function(b){return b[s]})};e.field=l;var f=function(s){return function(h){if(t.assert_is_pojo(h),!t.isPojoObject(h))throw"Value `"+h+"` is not of type `object` but rather `"+typeof h+"`";return Object.entries(s).map(function(g){var b=g[0],P=g[1];if(P[e.fieldDecoder]===!0)return[b,n.decode(P)(h)];try{var M=h[b];return[b,n.decode(P)(M)]}catch(A){throw A+("\nwhen trying to decode the key `"+b+"` in `"+JSON.stringify(h)+"`")}}).reduce(function(g,b){var P,M=b[0],A=b[1];return r(r({},g),(P={},P[M]=A,P))},{})}};e.record=f}(B)),B}var k;function L(){if(k)return O;k=1,Object.defineProperty(O,"__esModule",{value:!0}),O.isKey=O.decode=void 0;var e=K(),r=function(s){return typeof s=="string"},t=function(s){return Array.isArray(s)&&s.length===2&&s.every(d)},n=function(s){return typeof s=="object"&&s!==null&&Object.values(s).every(d)},o=function(s){return r(s)||t(s)||n(s)},a=function(s){if(r(s))return e.literal(s);if(t(s))return e.tuple(s[0],s[1]);if(n(s))return e.record(s);throw"shouldn't happen"},i=function(s){return typeof s=="function"},d=function(s){return o(s)||i(s)},l=function(s){return i(s)?s:a(s)};O.decode=l;function f(s,h){return h.includes(s)}return O.isKey=f,O}var W={},D={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.date=e.nil=e.undef=e.boolean=e.number=e.string=void 0;var r=J,t=function(i){if(r.assert_is_pojo(i),typeof i!="string")throw"The value `"+JSON.stringify(i)+"` is not of type `string`, but is of type `"+typeof i+"`";return i};e.string=t;var n=function(i){if(r.assert_is_pojo(i),typeof i!="number")throw"The value `"+JSON.stringify(i)+"` is not of type `number`, but is of type `"+typeof i+"`";return i};e.number=n;var o=function(i){if(r.assert_is_pojo(i),typeof i!="boolean")throw"The value `"+JSON.stringify(i)+"` is not of type `boolean`, but is of type `"+typeof i+"`";return i};e.boolean=o,e.undef=function(i){if(r.assert_is_pojo(i),typeof i<"u")throw"The value `"+JSON.stringify(i)+"` is not of type `undefined`, but is of type `"+typeof i+"`";return i},e.nil=function(i){if(r.assert_is_pojo(i),i!==null)throw"The value `"+JSON.stringify(i)+"` is not of type `null`, but is of type `"+typeof i+"`";return i};var a=function(i){r.assert_is_pojo(i);var d=e.string(i),l=Date.parse(d);if(isNaN(l))throw"String `"+d+"` is not a valid date string";return new Date(l)};e.date=a})(D);(function(e){var r=N&&N.__assign||function(){return r=Object.assign||function(c){for(var u,m=1,p=arguments.length;m<p;m++){u=arguments[m];for(var y in u)Object.prototype.hasOwnProperty.call(u,y)&&(c[y]=u[y])}return c},r.apply(this,arguments)},t=N&&N.__spreadArray||function(c,u){for(var m=0,p=u.length,y=c.length;m<p;m++,y++)c[y]=u[m];return c};Object.defineProperty(e,"__esModule",{value:!0}),e.dict=e.map=e.set=e.array=e.optional=e.nullable=e.intersection=e.union=void 0;var n=D,o=J,a=L(),i=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];return function(m){if(o.assert_is_pojo(m),c.length===0)throw"Could not match any of the union cases";var p=c[0],y=c.slice(1);try{return a.decode(p)(m)}catch(v){try{return e.union.apply(void 0,y)(m)}catch(_){throw v+`
`+_}}}};e.union=i;var d=function(c,u){var m=t(t(t(t([],Object.getOwnPropertyNames(c)),Object.getOwnPropertySymbols(c)),Object.getOwnPropertyNames(u)),Object.getOwnPropertySymbols(u));return m.reduce(function(p,y){var v,_=c[y],S=u[y];return r(r({},p),(v={},v[y]=y in c?y in u?function(){try{return f(_,S)}catch(I){throw I+`
While trying to combine results for field '`+String(y)+"'"}}():_:S,v))},{})},l=function(c){var u=Object.getPrototypeOf(c);if(u!==Object.prototype&&u!==Array.prototype)throw"Only Object, and Array, and the primitive types are allowed in intersections, but got "+u.constructor.name},f=function(c,u){var m=typeof c;if(m!==typeof u)throw"Cannot form intersection of "+typeof c+" and "+typeof u+", but got "+c+" and "+u;if(m==="function")throw"Combining functions in intersections is not supported";if(m==="object"){if([c,u].some(function(_){return _===null})){var p=[c,u].find(function(_){return _!==null});if(p!==void 0)throw"Cannot intersect null with non-null value "+p;return null}l(c),l(u);var y=d(c,u),v=Array.isArray(c)||Array.isArray(u)?[]:{};return Object.assign(v,y)}else{if(c!==u)throw"Intersections must produce matching values in all branches, but got "+c+" and "+u;return c}},s=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];return function(m){o.assert_is_pojo(m);for(var p=[],y=[],v=0,_=c;v<_.length;v++){var S=_[v];try{y.push(a.decode(S)(m))}catch(I){p.push(I)}}if(p.length===0)return y.length===0?{}:y.reduce(function(I,U){return f(I,U)});throw p.push("Could not match all of the intersection cases"),p.join(`
`)}};e.intersection=s;var h=function(c){return e.union(n.nil,c)};e.nullable=h;var g=function(c){return e.union(n.undef,c)};e.optional=g;function b(c){return function(u){o.assert_is_pojo(u);var m=function(y){return""+JSON.stringify(y)};if(!Array.isArray(u))throw"The value `"+m(u)+"` is not of type `array`, but is of type `"+typeof u+"`";var p=0;try{return u.map(function(y,v){return p=v,a.decode(c)(y)})}catch(y){throw y+(`
when trying to decode the array (at index `+p+") `"+m(u)+"`")}}}e.array=b;var P=function(c){return function(u){o.assert_is_pojo(u);try{return new Set(a.decode(b(c))(u))}catch(m){throw m+`
and can therefore not be parsed as a set`}}};e.set=P;var M=function(c,u){return function(m){o.assert_is_pojo(m);try{var p=a.decode(b(c))(m),y=new Map(p.map(function(v){return[u(v),v]}));return p.length!==y.size&&console.warn("Probable duplicate key in map: List `"+p+"` isn't the same size as the parsed `"+y+"`"),y}catch(v){throw v+`
and can therefore not be parsed as a map`}}};e.map=M;function A(c,u){return function(m){if(o.assert_is_pojo(m),!o.isPojoObject(m))throw"Value `"+m+"` is not an object and can therefore not be parsed as a map";var p=Object.entries(m).map(function(y){var v=y[0],_=y[1];try{if(u&&!a.isKey(v,u))throw"Key `"+v+"` is not in given keys";return[v,a.decode(c)(_)]}catch(S){throw S+("\nwhen decoding the key `"+v+"` in map `"+m+"`")}});return new Map(p)}}e.dict=A})(W);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.date=e.nil=e.undef=e.boolean=e.number=e.string=e.nullable=e.dict=e.map=e.set=e.array=e.optional=e.intersection=e.union=e.fields=e.field=e.record=e.literal=e.tuple=e.decode=void 0;var r=L();Object.defineProperty(e,"decode",{enumerable:!0,get:function(){return r.decode}});var t=K();Object.defineProperty(e,"tuple",{enumerable:!0,get:function(){return t.tuple}}),Object.defineProperty(e,"literal",{enumerable:!0,get:function(){return t.literal}}),Object.defineProperty(e,"record",{enumerable:!0,get:function(){return t.record}}),Object.defineProperty(e,"field",{enumerable:!0,get:function(){return t.field}}),Object.defineProperty(e,"fields",{enumerable:!0,get:function(){return t.fields}});var n=W;Object.defineProperty(e,"union",{enumerable:!0,get:function(){return n.union}}),Object.defineProperty(e,"intersection",{enumerable:!0,get:function(){return n.intersection}}),Object.defineProperty(e,"optional",{enumerable:!0,get:function(){return n.optional}}),Object.defineProperty(e,"array",{enumerable:!0,get:function(){return n.array}}),Object.defineProperty(e,"set",{enumerable:!0,get:function(){return n.set}}),Object.defineProperty(e,"map",{enumerable:!0,get:function(){return n.map}}),Object.defineProperty(e,"dict",{enumerable:!0,get:function(){return n.dict}}),Object.defineProperty(e,"nullable",{enumerable:!0,get:function(){return n.nullable}});var o=D;Object.defineProperty(e,"string",{enumerable:!0,get:function(){return o.string}}),Object.defineProperty(e,"number",{enumerable:!0,get:function(){return o.number}}),Object.defineProperty(e,"boolean",{enumerable:!0,get:function(){return o.boolean}}),Object.defineProperty(e,"undef",{enumerable:!0,get:function(){return o.undef}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return o.nil}}),Object.defineProperty(e,"date",{enumerable:!0,get:function(){return o.date}})})(E);const $=E.record({name:E.string,pinned:E.boolean,children:E.array(E.string)});function x(e,r,t){console.log("Filter : ",r);const n=[],o=ee(e,r.pinnedList);if(o instanceof Error)return o;const a=ne(o,r);console.log("Filtered Node",a);const i=new Map;a.forEach(l=>{if(l.pinned){const f=R(1,l.name),s=new w(100+(100*Math.random()-50),100+(100*Math.random()-50),100,100,!0,15,f);i.set(l.name,s)}else{const f=R(1,l.name),s=new w(100+(100*Math.random()-50),100+(100*Math.random()-50),100,100,!1,15,f);i.set(l.name,s)}});const d=[...i.values()];return a.forEach(l=>l.children.forEach(f=>{const s=z("black",1);let h=i.get(l.name),g=i.get(f);if(h&&g){const b=new q(h,g,160,.001,s);n.push(b)}})),l=>new Q(l,d,n,t)}function ee(e,r){return Object.entries(e).map(([t,n])=>{let o=!1;return r instanceof RegExp?o=r.test(t):o=r.includes(t),E.decode($)({name:t,pinned:o,children:n})})}function te(e,r){let t=r.list;if(t instanceof RegExp){let n=t;return e.filter(o=>n.test(o.name)).map(o=>o.name)}else return t}function ne(e,r){const t=te(e,r),n=new Set(t),o=new Map;e.forEach(l=>o.set(l.name,l));const a=new Map;e.forEach(l=>l.children.forEach(f=>{let s=a.get(f);s?a.set(f,s.concat([l])):a.set(f,[l])})),console.log("Parents : ",a);let i=[...t];for(let l=1;l<=r.includeNthChild;++l){let f=new Set;i.forEach(s=>{let h=o.get(s);h&&h.children.forEach(g=>f.add(g))}),f.forEach(s=>n.add(s)),i=Array.from(f.values())}let d=[];r.includeNthParent>0&&(t.forEach(l=>{const f=a.get(l);f&&(d=d.concat(f))}),d.forEach(l=>n.add(l.name)));for(let l=2;l<=r.includeNthParent;++l){let f=new Set;d.forEach(s=>{const h=a.get(s.name);h&&h.forEach(g=>f.add(g))}),f.forEach(s=>n.add(s.name)),d=Array.from(f.values())}return e.filter(l=>{const f=!!n.has(l.name);return r.mode=="blacklist"?!f:f})}function re(){let e=document.getElementById("whitelist"),r=document.getElementById("blacklist"),t=document.getElementById("nthchild"),n=document.getElementById("nthparent"),o=0,a=0;if(e.checked||r.checked){let i=document.getElementById("list").value.replace(/'/g,'"').trim(),d=document.getElementById("pinned").value.replace(/'/g,'"').trim(),l=[],f=[];try{if(l=JSON.parse(i),!(l instanceof Array))throw new Error("filterlist is not Array")}catch(s){console.error(s),l=new RegExp(i==""?".*":i)}try{if(f=JSON.parse(d),!(f instanceof Array))throw new Error("pinnedlist is not Array")}catch(s){console.error(s),f=new RegExp(d==""?"\b":d)}try{o=parseInt(t.value)}catch{o=0}try{a=parseInt(n.value)}catch{a=0}return{mode:e.checked?"whitelist":"blacklist",list:l,pinnedList:f,includeNthChild:o,includeNthParent:a}}else return{mode:"whitelist",list:[],pinnedList:[],includeNthChild:0,includeNthParent:0}}function ie(){let e=document.getElementById("input"),r=re();try{let t=JSON.parse(e.value);const n=x(t,r,.01);if(n instanceof Error)throw n;{let o=document.createElement("canvas");o.width=document.body.clientWidth,o.height=document.body.clientHeight,document.getElementById("card").remove(),document.body.appendChild(o),n(o).run()}}catch(t){t instanceof Error?alert("Error, "+t.message):alert("Error, check console"),console.error(t)}}window.onload=function(){document.getElementById("submit").onclick=function(){localStorage.json=document.getElementById("input").value,localStorage.filterlist=document.getElementById("list").value,localStorage.pinned=document.getElementById("pinned").value,localStorage.nthchild=document.getElementById("nthchild").value,localStorage.nthparent=document.getElementById("nthparent").value,ie()},localStorage.json&&(document.getElementById("input").value=localStorage.json),localStorage.nthchild&&(document.getElementById("nthchild").value=localStorage.nthchild),localStorage.nthparent&&(document.getElementById("nthparent").value=localStorage.nthparent),localStorage.filterlist&&(document.getElementById("list").value=localStorage.filterlist),localStorage.pinned&&(document.getElementById("pinned").value=localStorage.pinned)};
